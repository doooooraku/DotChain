# 1.5_UI_画面設計書（DotChain v1.0）

---

## 1. このドキュメントの目的

この「1.5_UI_画面設計書.md」は、DotChain v1.0 の**画面構成とUI挙動**を定義するドキュメントです。

- 0_プロダクト戦略.md：プロダクトの目的・ゴール・ターゲット
- 1_基本仕様書.md：機能一覧（F-01〜F-07）の定義
- **1.5_UI_画面設計書.md：各機能を“どの画面でどう見せるか”の仕様**
- 2_機能設計書.md：画面遷移・ユースケース・シーケンスの詳細

という位置づけです。

このファイルだけで、

- 画面ID（S-01〜S-04）と役割
- 各画面に「どのコンポーネントがどの順番で配置されるか」
- Free / Pro 状態による見た目・表示有無の違い
- トースト / ダイアログなどの共通UI

が分かることを目標にします。

---

## 2. 用語定義（UIまわり）

UI設計で繰り返し出てくる用語の意味を、先に整理しておきます。

- **画面ID（Screen ID）**  
  各画面を識別するためのID。例：S-01 ホーム、S-02 設定など。仕様書・コード・デザインツールで共通して用いる。

- **コンポーネント（Component）**  
  ボタン・テキスト・カード・アイコンなど、画面を構成する部品。再利用可能な UI のかたまりを指す。

- **FAB（Floating Action Button）**  
  画面右下などに浮かんでいる「＋」ボタンのようなもの。主なアクション（ここでは“習慣追加”）を表す。

- **トースト（Toast）**  
  画面下部や中央にふわっと表示され、数秒で自動的に消える小さなメッセージ。ユーザー操作を妨げない通知手段。

- **ダイアログ / アラート（Dialog / Alert）**  
  画面中央に表示される小さなポップアップ。ユーザーの確認（OK / キャンセルなど）を必須とする。

- **アクセントカラー（Accent Color）**  
  ボタンや強調テキストなどに使う色。DotChain ではテーマごとに異なるネオン系カラーを使う。

- **テーマ（Theme）**  
  アプリ全体の色の組み合わせ。背景・テキスト・アクセントカラーのセット。DotChain では Dark / Neon Pink / Cyber Blue の3種類。

---

## 3. 画面一覧と役割

DotChain v1.0 で扱う画面を以下の4つに整理します。

| ID   | 画面名                  | 目的                                                       |
|------|-------------------------|------------------------------------------------------------|
| S-01 | ホーム画面              | 今日の習慣の実行・チェーンの確認・習慣追加への入り口     |
| S-02 | 設定画面                | 言語 / テーマ / 効果音 / 振動 / ヒートマップ範囲 / 復元  |
| S-03 | 習慣編集画面（追加/編集）| 習慣の作成・編集・削除                                    |
| S-04 | Proプラン紹介 / 購入画面 | Free/Pro比較・価格表示・サブスク購入フローの入り口       |

ウィジェット画面・アプリアイコン変更画面・OSSライセンス専用画面は **v1.0では存在しない** 前提です。

---

## 4. ナビゲーション構造（高レベル）

### 4-1. ベース構造

- シングルスタック構造（タブバーなし）
- ホーム画面 S-01 がルート画面
- その他の画面は S-01 からモーダルまたはプッシュ遷移

### 4-2. 画面遷移マップ（テキスト表現）

- **S-01 ホーム**
  - → S-02 設定
    - [右上の歯車アイコン] をタップ
  - → S-03 習慣編集（新規）
    - [右下FABの＋ボタン] をタップ
  - → S-03 習慣編集（既存）
    - 各習慣行の [編集アイコン] をタップ
  - → S-04 Pro
    - ヘッダー右上の [Proバッジ / 王冠アイコン] をタップ（Free時）
    - Free制限到達時のダイアログから [Proを確認] をタップ

- **S-02 設定**
  - ← S-01 へ戻る
    - 画面左上の [戻る矢印] をタップ
  - → S-04 Pro
    - 設定内の [Proプラン] 行をタップ
    - テーマ選択のロックされたテーマをタップ

- **S-03 習慣編集**
  - ← S-01 へ戻る
    - 左上の [×] または [戻る矢印] をタップ
    - 保存後に自動で S-01 に戻る

- **S-04 Pro**
  - ← 呼び出し元（S-01 または S-02）へ戻る
    - 左上の [閉じる] ボタンをタップ

---

## 5. 共通UIルール

### 5-1. レイアウト・余白

- 画面左右の基本マージン：**16dp**
- コンポーネント間の縦方向スペース：
  - セクション間：24dp
  - 行間（リスト行同士）：12dp
  - ボタンと説明テキスト：8dp
- スクロール方向：縦スクロールのみ（横スクロールはアイコンピッカーなど一部コンポーネント内のみに限定）

### 5-2. タイポグラフィ（フォントサイズ）

| 用途             | サイズ | ウェイト | 例                                   |
|------------------|--------|----------|--------------------------------------|
| 画面タイトル     | 24sp   | Bold     | 「DotChain」「設定」「DotChain Pro」 |
| セクションタイトル | 18sp   | SemiBold | 「習慣」「今日」「外観」「言語」     |
| 行タイトル       | 16sp   | Regular  | 「テーマ」「言語」「効果音」など   |
| 補足説明文       | 14sp   | Regular  | Pro比較表の注記など                 |
| ラベル / バッジ  | 12sp   | SemiBold | 「FREE」「PRO」「New」バッジなど    |

※ sp は画面密度に応じたスケーリングを行う単位です（React Nativeでは DP だが、フォントとしてはスケーリング対応）。

### 5-3. カラールール（テーマ共通）

基本となる Dark テーマをベースに記載します。Neon Pink / Cyber Blue テーマでは、主にアクセントカラーが変わる前提です。

- 背景色：`BG_MAIN`  
  - Dark：#050814 付近の濃紺
- カード背景：`BG_CARD`  
  - Dark：#0B1020
- 主要テキスト：`TEXT_PRIMARY`  
  - #FFFFFF（不透明度 87% 程度）
- 補足テキスト：`TEXT_SECONDARY`  
  - #FFFFFF（不透明度 60% 程度）
- アクセントカラー：`ACCENT`（テーマごとに変化）  
  - Dark：#39FF14（ネオングリーン）
  - Neon Pink：#FF65D8
  - Cyber Blue：#00C8FF
- エラー色：`ERROR`  
  - #FF4D4F 付近の赤

### 5-4. ボタンスタイル

- プライマリボタン
  - 背景：`ACCENT`
  - テキスト：白
  - 角丸：12dp
  - 高さ：44dp
  - 使用例：
    - 「保存」「Proを始める」

- セカンダリボタン
  - 背景：透明
  - 枠線：`ACCENT`
  - テキスト：`ACCENT`
  - 使用例：
    - 「キャンセル」「閉じる」

- テキストボタン
  - テキストだけのボタン（リンク風）
  - 使用例：「利用規約」「プライバシーポリシー」

---

## 6. 画面別UI仕様

ここから各画面（S-01〜S-04）ごとに、領域構成・コンポーネント・状態を定義します。

---

### S-01 ホーム画面

#### 6-1-1. 目的

- ユーザーが **毎日最初に開く画面**。
- 今日の習慣達成操作（ワンタップ記録）と、チェーンの視覚的な確認を行う。

#### 6-1-2. 画面構造（上から順番）

1. **ステータスバー / セーフエリア**
2. **ヘッダーバー**
   - 左：アプリ名「DotChain」またはロゴ
   - 中央：今日の日付（例：2025年11月30日（日））
   - 右：
     - Free時：歯車アイコン（設定） + 王冠アイコン（Pro）
     - Pro時：歯車アイコンのみ（Proバッジはタイトル横に小さく表示してもよい）
3. **今日の概要セクション**
   - テキスト例：「今日：3/5 チェーン継続中」
   - 進捗バー（達成習慣 / 登録習慣）の簡易表示
4. **習慣リストセクション**
   - 縦方向のリスト。
   - 各行 = 1習慣（コンポーネント名：`HabitListItem`）。
5. **カレンダー / ヒートマップセクション**
   - 過去30〜365日のヒートマップ（設定に応じて範囲変更）。
   - 各日付を小さなドットや小マスで表示。
6. **広告セクション（Freeのみ）**
   - 画面下部に AdMob バナー。
7. **浮遊アクションボタン（FAB）**
   - 右下に「＋」アイコンボタン。習慣の新規追加（S-03遷移）。

#### 6-1-3. コンポーネント詳細

##### (1) ヘッダーバー

| 要素ID         | 種類      | 内容/ラベル                        | 挙動                                      |
|----------------|-----------|-------------------------------------|-------------------------------------------|
| HEADER_TITLE   | テキスト  | 「DotChain」                       | タップしても何もしない                   |
| HEADER_DATE    | テキスト  | 「2025年11月30日（日）」など      | タップしても何もしない                   |
| BTN_SETTINGS   | アイコン  | 歯車アイコン                       | タップで S-02 設定画面へ                 |
| BTN_PRO_BADGE  | アイコン/バッジ | 王冠アイコン + 「Pro」テキスト（Free時のみ表示） | タップで S-04 Pro 画面へ                 |

- プロ状態のとき：
  - 王冠アイコンは非表示。
  - 代わりにタイトル横に「PRO」小バッジ表示など検討（視覚的に Pro を示す）。

##### (2) 今日の概要セクション

- テキスト例：
  - Free / Pro 共通：「今日：2/3 達成」「今日：4/7 達成」
- サブテキストに「最長チェーン：21日」などを配置してもよい（詳細設計で調整）。

##### (3) 習慣リスト (`HabitListItem`)

1行の構成：

| 部位         | 内容                                           |
|--------------|------------------------------------------------|
| 左アイコン   | 丸型アイコン（例：ダンベル / 本 / 勉強帽子など）|
| 中央テキスト | 1行目：習慣名、2行目：サブ情報（現在チェーン日数など）|
| 右側ボタン   | 今日の達成トグルボタン（カード状の HabitButton） |
| 右端アイコン | 編集アイコン（鉛筆）                           |

- トグルボタン仕様：
  - 形状：カード型ボタン（大：160dp、高さ / 中：110dp、高さ）
  - 未達成：背景はテーマのベース色、枠線は `ACCENT`、グローは最小値で静的（アニメなし）
  - 達成済み：背景が `ACCENT` で塗りつぶし、アイコン色は黒、ネオングローが 0.4〜0.7 の範囲でゆらめく（active のときのみアニメーション）
  - タップ時：軽い拡大縮小アニメーション + 効果音（ONの場合） + 振動（ONの場合）

- 行全体のタップ挙動：
  - 中央付近をタップ → トグルと同じ挙動（達成/未達成切替）。
  - 編集アイコンのみタップ → S-03 習慣編集画面へ。

##### (4) カレンダー / ヒートマップ

- 1ヶ月=1行、または複数行のグリッド表示。
- 各マス：
  - 達成：`ACCENT`色の小さな丸または四角
  - 未達成：背景に近い暗い色
- タップ：v1.0では必須機能ではないため、タップしても単なるハイライトのみ（詳細な日別一覧画面は作らない）。

##### (5) 広告セクション（Freeのみ表示）

- `AdBanner` コンポーネントをそのまま表示。
- Pro時：この領域は完全に非表示（ダミーの余白も不要）。

##### (6) FAB（＋ボタン）

- 右下固定、円形 56dp、`ACCENT` 塗りつぶし。
- 中央に白の「＋」アイコン。
- タップで S-03 新規習慣編集画面へ。

#### 6-1-4. 状態と分岐

- **ログイン状態**：v1.0ではアカウント機能なし → 考慮不要。
- **Free / Pro 状態**：
  - Free：
    - HEADER 右に王冠（Proバッジ）表示。
    - 広告セクション表示。
  - Pro：
    - 王冠非表示。
    - 広告セクション非表示。

- **習慣ゼロ件時（初回起動など）**：
  - 習慣リストセクションに以下を表示：
    - イラスト or アイコン（大きな＋ or チェーンアイコン）
    - テキスト：「最初の習慣を追加してみましょう」
    - ボタン：「習慣を追加」（FAB と同じ挙動で S-03 へ）

---

### S-02 設定画面

#### 6-2-1. 目的

- アプリの見た目・挙動・言語・Pro状態に関する設定を行う画面。

#### 6-2-2. 画面構造（上から順番）

1. **ヘッダーバー**
   - 左：戻る矢印アイコン
   - 中央：タイトル「設定」
   - 右：空（特になし）

2. **セクション：アカウント / Pro**
   - 行1：Proステータス & Pro画面遷移
   - 行2：「購入を復元」ボタン

3. **セクション：外観（Appearance）**
   - 行1：テーマ選択（3テーマ）

4. **セクション：動作（Behavior）**
   - 行1：効果音 ON/OFF
   - 行2：振動 ON/OFF
   - 行3：演出エフェクト（電流） ON/OFF
   - 行4：ヒートマップ表示範囲（30/60/180/365日）

5. **セクション：言語（Language）**
   - 言語一覧（18言語）

6. **セクション：その他**
   - 行1：利用規約
   - 行2：プライバシーポリシー

#### 6-2-3. コンポーネント詳細

##### (1) ヘッダーバー

| 要素ID       | 種類     | 内容/ラベル | 挙動                                  |
|--------------|----------|-------------|---------------------------------------|
| BTN_BACK     | アイコン | ←（左矢印） | タップで前の画面（多くは S-01）に戻る |
| TITLE        | テキスト | 「設定」    | 挙動なし                              |

##### (2) セクション：アカウント / Pro

行1：Pro ステータス

| 要素ID           | 種類       | 内容/ラベル                      | 挙動                                                  |
|------------------|------------|----------------------------------|-------------------------------------------------------|
| ROW_PRO_STATUS   | 行         | 左：テキスト「プラン」、右：バッジ| タップで S-04 Pro画面へ                               |
| LABEL_PLAN       | テキスト   | 「プラン」                       | なし                                                  |
| VALUE_PLAN_BADGE | バッジ     | Free時：「FREE」、Pro時：「PRO」 | 見た目のみ変更                                       |

行2：「購入を復元」

| 要素ID            | 種類     | 内容/ラベル     | 挙動                                  |
|-------------------|----------|-----------------|---------------------------------------|
| ROW_RESTORE       | 行       | 「購入を復元」  | タップで Pro復元処理（F-04）を実行   |
| LABEL_RESTORE     | テキスト | 「購入を復元」  | なし                                  |

##### (3) セクション：外観（テーマ選択）

- 一行に3つのテーマ丸ボタン（`ThemeDot` コンポーネント）を横並び。

| テーマ       | ラベル例        | カラー        | Freeでの状態   | Proでの状態     |
|--------------|-----------------|--------------|----------------|-----------------|
| Dark         | 「Dark」        | ネオングリーン | 選択可能       | 選択可能        |
| Neon Pink    | 「Neon Pink」   | ピンク        | ロック表示     | 選択可能        |
| Cyber Blue   | 「Cyber Blue」  | サイバーブルー | ロック表示     | 選択可能        |

- ロック表示：
  - アイコン右下に小さな鍵アイコン。
  - ラベル色を半透明にする。

- 挙動：
  - Free時：
    - Dark以外をタップすると S-04 Pro画面へ。
  - Pro時：
    - タップしたテーマを即時適用。

##### (4) セクション：動作（効果音 / 振動 / エフェクト / ヒートマップ）

- 効果音 / 振動 / エフェクト：
  - 各行は「左テキスト + 右トグルスイッチ」構成。
  - ON：`ACCENT`色
  - OFF：グレー

- ヒートマップ表示範囲：
  - 例：ラベル「ヒートマップ表示期間」、右側に現在値「過去60日」など。
  - タップするとボトムシートまたはダイアログで選択肢（30, 60, 180, 365日）を表示。

##### (5) セクション：言語（Language）

- 「Language」セクション内に18言語のリスト。
- 各行：
  - 左：言語名（例：English、日本語、Français）
  - 右：チェックマーク（選択中のみ）

- タップ時：
  - 選択状態を更新し、アプリ全体の言語を即時切換え。

##### (6) セクション：その他

- 利用規約 / プライバシーポリシー 行：
  - タップで外部ブラウザまたはアプリ内WebViewに遷移。

---

### S-03 習慣編集画面（追加 / 編集）

#### 6-3-1. 目的

- 新しい習慣を作成する。
- 既存の習慣を編集・削除する。

#### 6-3-2. 画面構造

1. **ヘッダーバー**
   - 左：閉じる（×）または戻る矢印
   - 中央：タイトル
     - 新規作成時：「習慣を追加」
     - 編集時：「習慣を編集」
   - 右：なし

2. **フォーム領域**
   - 入力1：習慣名（TextInput）
   - 入力2：アイコン選択（横スクロールのアイコンリスト）
   - 入力3：カラー選択（丸型カラーDot）

3. **アクションボタン領域**
   - 左：キャンセル（セカンダリ）
   - 右：保存（プライマリ）
   - 編集時のみ画面下部に「削除」ボタン（赤）

#### 6-3-3. コンポーネント詳細

##### (1) 習慣名入力

- プレースホルダ例：「習慣名（例：筋トレ／英語／読書）」
- 最大文字数：例 30文字
- バリデーション：
  - 未入力で保存ボタンタップ → エラー表示（テキスト or 下線色を赤にし、「習慣名を入力してください」とトースト表示）。

##### (2) アイコン選択

- 3〜4行分のプリセットアイコン（例：本、ダンベル、ペン、ランニングマン、PCなど）。
- 1つのみ選択可。
- 選択中のアイコンは枠線 + `ACCENT`でハイライト。

##### (3) カラー選択

- 例えば6色程度のドット：
  - ACCENTグリーン / イエロー / オレンジ / ピンク / ブルー / パープル
- 選択中のドットに枠線を表示。

##### (4) アクションボタン

- 「キャンセル」ボタン：
  - タップで S-01 に戻る（変更を保存せず破棄）。

- 「保存」ボタン：
  - 新規作成時：
    - Free版で既に3件登録済みの場合 → F-02の仕様に基づき **ダイアログ表示**（保存せず）。
    - そうでない場合 → データ保存 → S-01 に戻る。
  - 編集時：
    - その習慣の情報を更新して保存.

- 「削除」ボタン（編集時のみ）：
  - 赤色のテキストボタン or アウトラインボタン。
  - タップすると確認ダイアログ（「この習慣と記録を削除しますか？」）。

---

### S-04 Proプラン紹介 / 購入画面

#### 6-4-1. 目的

- FreeとProの違いを一目で理解してもらう。
- 価格・プランを明確に提示し、RevenueCat 経由の購入フローに進ませる。

#### 6-4-2. 画面構造

1. **ヘッダーバー**
   - 左：閉じる（×）
   - 中央：タイトル「DotChain Pro」
   - 右：空

2. **ヒーローセクション（上部）**
   - DotChainロゴ + 「習慣に、ネオンのチェーンを」などのキャッチコピー。
   - 背景にグラデーション（テーマに応じたネオン系）。

3. **比較表セクション**

   | 機能        | Free           | Pro                        |
   |-------------|----------------|----------------------------|
   | 習慣数      | 最大3件        | 無制限                     |
   | 広告        | バナー広告あり | 広告なし                   |
   | テーマ      | Darkのみ       | Dark / Neon Pink / Cyber Blue |

4. **プラン選択セクション**
   - カード形式で **月額 / 年額** を表示。
   - 各カードには：
     - プラン名（例：「月額プラン」）
     - 価格（例：「¥360/月」）
     - 補足（例：「いつでもキャンセル可能」）
   - どちらかをタップすると購入処理開始。

5. **補足情報セクション**
   - テキスト：
     - 「価格は地域や通貨により異なる場合があります。」
     - 「サブスクリプションは自動更新されます。設定からいつでも解約できます。」

6. **フッターリンク**
   - 「利用規約」「プライバシーポリシー」へのリンク。

#### 6-4-3. 挙動

- Free時：
  - 比較表・プラン選択など全て表示。
- Pro時：
  - 画面上部に「すでに Pro プランが有効です」といったメッセージを表示。
  - 購入カードを押しても実際の購入処理は行わず、`isPro` を保持したままにする。

- いずれかのプランカードタップ時：
  - RevenueCat SDK を通じてストアの購入画面へ。
  - 成功時：
    - Alert（ダイアログ）で「Proプランが有効になりました」。
    - S-01 または S-02 に戻る（呼び出し元に応じて）。
  - 失敗時：
    - トーストでエラーメッセージを表示する。

---

## 7. 共通UI（ダイアログ / トースト）

### 7-1. ダイアログ（Alert）

代表的なダイアログのパターンを定義します。

#### (1) Free上限到達時（4件目の習慣保存時）

- タイトル：
  - 「無料版の上限に達しました」
- メッセージ：
  - 「無料版では習慣は3つまでです。Proにアップグレードすると無制限に追加できます。」
- ボタン：
  - 左：「キャンセル」
  - 右：「Proを確認する」→ S-04 へ遷移

#### (2) Pro購入成功時

- タイトル：
  - 「Proプランが有効になりました」
- メッセージ：
  - 「習慣数の上限がなくなり、広告も非表示になります。」
- ボタン：
  - 「OK」（押下で画面を閉じる）

#### (3) 購入復元成功時

- タイトル：
  - 「購入を復元しました」
- メッセージ：
  - 「この端末でも Pro プランが利用できます。」

#### (4) 習慣削除確認

- タイトル：
  - 「習慣を削除しますか？」
- メッセージ：
  - 「この習慣と、これまでの記録がすべて削除されます。」
- ボタン：
  - 左：「キャンセル」
  - 右：「削除」（赤系の強調）

### 7-2. トースト（Toast）

主にエラーや軽めの通知に使用します。

#### デザイン

- 画面下部中央に表示。
- 幅：画面幅の 80% 程度。
- 背景色：
  - 正常系：`BG_CARD`
  - エラー系：`ERROR` 色に近い濃い赤
- テキスト：白
- 表示時間：2〜3秒

#### 利用場面の例

- Pro購入失敗時
  - メッセージ例：「購入に失敗しました。時間をおいて再度お試しください。」
- 購入復元失敗時
  - 「購入の復元に失敗しました。」
- 復元対象がない場合
  - 「復元できる購入は見つかりませんでした。」
- 習慣保存時のバリデーションエラー（名前未入力等）
  - 「習慣名を入力してください。」

---

## 8. 状態別UIまとめ（Free / Pro / 初回）

### 8-1. Free版ユーザー

- S-01 ホーム
  - ヘッダー右上に王冠（Proバッジ）表示
  - 広告バナー表示
  - 習慣数 3件まで
- S-02 設定
  - テーマ選択で Neon Pink / Cyber Blue がロック表示
  - プラン表示バッジが「FREE」
- S-03
  - 4件目保存時に Pro誘導ダイアログ
- S-04
  - 通常の比較表＋プラン選択表示

### 8-2. Pro版ユーザー

- S-01 ホーム
  - 王冠アイコン非表示（必要ならタイトル横に小さく「PRO」など）
  - 広告バナー非表示
  - 習慣数制限なし
- S-02 設定
  - テーマ3種すべて選択可能
  - プラン表示バッジが「PRO」
- S-03
  - 4件目以降も通常通り保存可能
- S-04
  - 冒頭に「すでに Pro プランが有効です」と表示

### 8-3. 初回起動時

- S-01 ホーム
  - 習慣リストが空 → 「最初の習慣を追加」カードを表示
  - FAB を強調表示（1回だけアニメーションするなど）
  - 画面全体に TutorialOverlay を 1 回だけ表示し、最初の操作手順を案内（表示フラグは `hasSeenOnboarding` で管理）
  - 専用の Onboarding 画面は v1.0 では使用しない（初回体験はホーム上で完結）

---

## 9. UI設計の参考にしたアプリ

DotChain のUI設計にあたり参考にしたアプリを記載します（あくまで参考。コピーではなく、DotChain の世界観に合わせてアレンジ）。

- **Loop Habit Tracker**（シンプルな習慣トラッカー）  
  https://loophabits.org/  
  https://play.google.com/store/apps/details?id=org.isoron.uhabits

- **Streaks**（ストリーク強調の習慣アプリ）  
  https://streaksapp.com/  
  https://apps.apple.com/app/streaks/id963034692

- **Habitify**（マルチプラットフォームの習慣アプリ）  
  https://habitify.me/

- **Productive**（「ポジティブな習慣」にフォーカス）  
  https://productiveapp.io/

これらを参考にしつつ、DotChain では「ネオンサイバーな世界観」「チェーンの気持ちよさ」「Freeでも本気で使えること」を重視した UI としています。

---

この 1.5_UI_画面設計書.md をベースに、

- 2_機能設計書.md：ユースケースごとの画面遷移・入力制御
- 3_詳細設計書.md：コンポーネント構造・Props・Store構成

へと落としこんでいきます。
