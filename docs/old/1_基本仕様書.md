
# 1_基本仕様書.md（DotChain）

> このドキュメントは、「DotChain」というアプリの**全体像、品質基準、技術的な決まりごと**をまとめた「設計図」です。
> 細かい画面の見た目は「UI設計書」、詳しいプログラムの中身は「詳細設計書」に書きますが、まずはこのファイルで**「何を作るのか」**を確定させます。

---

## 1. 概要

### 1.1 本書の位置づけ

* **役割**:
  * 「0_プロダクト戦略」で決めた「快感重視の習慣アプリ」というコンセプトを、**開発できるレベルの仕様**に翻訳します。
  * 開発中、迷ったときの「憲法」のような存在です。
* **対象読者**:
  * 開発者（あなた）
  * テスター（動作確認をする時の基準になります）

### 1.2 アプリ名・バージョン

* **アプリ名（日）**: DotChain（ドットチェーン）
* **アプリ名（英）**: DotChain
* **初期バージョン**: v1.0.0
* **開発コードネーム**: Pop-Habit（ポップ・ハビット）

### 1.3 コンセプト（要約）

* **一言コンセプト**:
  **「『努力』を『快感』に変える、デジタル・フィジェット（手遊び）習慣ツール」**
* **エレベーターピッチ**:
  多くの習慣アプリは「管理」や「義務」になりがちですが、DotChainは「ボタンを押した瞬間の気持ちよさ（触覚・視覚）」を最優先にします。言葉の壁を超え、直感だけで「明日も押したい」と思わせることで、結果として習慣が続く世界を作ります。

### 1.4 対応プラットフォーム・デバイス

* **iOS (iPhone)**:
  * iOS 15.0 以上
  * ※iPadは「スマホ互換表示」で動作保証するが、専用レイアウトは作らない。
* **Android**:
  * Android 10.0 (API Level 29) 以上
* **画面の向き**:
  * **縦画面 (Portrait) 固定**。横画面には対応しない。
* **対応言語 (19言語)**:
  * 英語、日本語、中国語(簡/繁)、スペイン語、アラビア語(RTL対応)、他多数。
  * ※詳細は「UI_画面設計書」参照。

### 1.5 リリース形態

* **ストア公開**: App Store / Google Play Store
* **ターゲット**: 全世界の一般ユーザー (Global Release)

---

## 2. 開発の背景と目的

### 2.1 開発の背景

* **現状**: 「習慣化したい」と思っている人は多いが、高機能なアプリは設定が面倒で続かない。また、既存アプリは「データ管理」に寄りすぎており、「使っていて楽しい」ものが少ない。
* **課題**: 「3日坊主」の原因は、意志の弱さではなく「アプリを開くのが面倒」「入力がつまらない」というUX（体験）の問題にある。特にADHD傾向のあるユーザーなどは、即座の報酬（音や光）がないと動機づけが続かない。

### 2.2 解決したい課題（ペイン）

* **機能的ペイン**:
  * 設定が複雑で、使い始めるまでに時間がかかる。
  * オフラインや電波の悪い場所（地下鉄、寝室）でサッと記録できない。
* **感情的ペイン**:
  * 「また続かなかった」という自己否定感。
  * 事務的な画面を見て感じる「やらされ仕事」感。

### 2.3 達成したいゴール

* **ユーザー**:
  * 「ボタンを押すのが気持ちいいから、気づいたら続いていた」という体験を得る。
  * 自分の積み上げ（ドットの鎖）を見て、自己肯定感が高まる。
* **ビジネス**:
  * V1.0リリース後、バグ修正以外の機能追加なしで、長期的に収益（サブスク/広告）を生み出す「資産」となること。

---

## 3. ターゲットユーザー

### 3.1 メインターゲット

* **属性**: 全世界の Z世代〜ミレニアル世代（スマホネイティブ）。
* **性格**:
  * **ミニマリスト志向**: シンプルなものが好き。ごちゃごちゃしたUIを嫌う。
  * **感覚派**: 説明書を読まない。直感で操作したい。
  * **ニューロダイバーシティ**: ADHD傾向などがあり、ゲーミフィケーション（音や光）による刺激を求めている。

### 3.2 利用シーン

* **朝**: 起きてすぐ、ベッドの中で「白湯を飲む」などのルーチンをワンタップ。
* **夜**: 寝る直前、暗い部屋で「日記を書く」などの習慣を記録。
  * ※だからこそ「ダークモード（黒背景）」が標準で必須。

---

## 4. 要求仕様

### 4.1 機能要求 (MUST / SHOULD / NICE)

V1.0で「完成形」とするため、NICE（あったらいいな）は基本的にありません。全てMUST（必須）かSHOULD（推奨）です。

| ID | 機能分類 | 機能名 | 優先度 | 概要 |
| :--- | :--- | :--- | :--- | :--- |
| **F-01** | **記録** | **ワンタップ記録** | **MUST** | メイン画面のボタンを押して完了/取消を行う。最重要機能。 |
| **F-02** | **演出** | **Popエフェクト** | **MUST** | 記録時の「コンッ」という振動、効果音、光のパーティクルアニメーション。 |
| **F-03** | **一覧** | **ヒートマップ** | **MUST** | 過去1年分のドット（鎖）を表示する。横スクロール可能。 |
| **F-04** | **編集** | **習慣管理** | **MUST** | 習慣の追加、名前変更、アイコン変更、削除。無料版は3つまで。 |
| **F-05** | **設定** | **多言語切替** | **MUST** | 19言語への対応と、**RTL（右から左）レイアウト反転**。即時反映。 |
| **F-06** | **課金** | **Proプラン** | **MUST** | 制限解除（習慣数無制限、全カラーテーマ開放、アイコン変更）。 |
| **F-07** | **広告** | **バナー広告** | **MUST** | 無料ユーザー向けの画面下部バナー。操作を邪魔しない位置。 |
| **F-08** | **拡張** | **ウィジェット** | **MUST** | ホーム画面からアプリを開かずに記録状況確認・記録。 |
| **F-09** | **拡張** | **アプリアイコン変更** | **MUST** | ユーザーがホーム画面アイコンを選べる機能（Pro限定）。 |

### 4.2 非機能要求（品質基準）

#### 4.2.1 パフォーマンス（速さ・感触）
* **起動速度**: コールドスタート（完全に止まっている状態からの起動） **1.5秒以内**。
* **反応速度 (Latency)**: ボタンをタップしてから、音と振動が返ってくるまで **0.1秒以内**。これが遅れると「気持ちよさ」が消えるため厳守。

#### 4.2.2 オフライン対応（重要）
* **完全オフライン動作**: 機内モードでも全ての機能（記録、編集、設定、課金状態のキャッシュ確認）が使えること。
* **データ同期**: V1.0ではクラウド同期（複数端末での共有）は**行わない**。

#### 4.2.3 ユーザビリティ
* **親指完結**: 主要な操作ボタンは画面の下半分に配置する。
* **文字レス**: 文字を読まなくても、色とアイコンだけで状態が分かるUIにする。
* **ダークモード標準**: 有機ELディスプレイで映える「完全な黒（#000000）」をベースにする。

#### 4.2.4 アクセシビリティ
* **RTL対応**: アラビア語などの言語設定時、画面レイアウトを左右反転させる。
* **コントラスト**: ネオンカラーを使用するが、視認性を損なわないよう配慮する。

---

## 5. 画面仕様（サマリ）

※詳細は「1.5_UI_画面設計書」を参照。ここでは全体構成のみ定義。

| 画面ID | 画面名 | 役割 |
| :--- | :--- | :--- |
| **S-01** | **ホーム** | メイン画面。習慣ボタン、ヒートマップ表示。一番長く見る画面。 |
| **S-02** | **設定** | 言語、音、振動、カラーテーマの設定。 |
| **S-03** | **編集** | 習慣の追加・修正（モーダル表示）。 |
| **S-04** | **課金** | Proプランへの誘導（Paywall）。魅力的なアニメーション付き。 |
| **S-05** | **ガイド** | 初回起動時のオンボーディング（オーバーレイ）。指差しアイコンで操作を教える。 |

---

## 6. 技術仕様（Tech Stack）

### 6.1 開発環境・フレームワーク
* **Framework**: Expo SDK 54 (Managed Workflow)
* **Core**: React Native 0.81
* **Language**: TypeScript
* **UI**: Tamagui (高速・高機能なUIコンポーネント)
* **Navigation**: Expo Router (ファイルベースルーティング)

### 6.2 データ保存 (Persistence)
* **メインデータ (習慣・記録)**:
  * **SQLite (expo-sqlite)** を使用。
  * リレーショナルデータベースとして正規化して保存する。
  * `habits` テーブル（親）と `logs` テーブル（子）の構成。
* **設定データ (言語・テーマ)**:
  * **AsyncStorage** を使用。
  * 軽微なKey-Valueデータを保存。

### 6.3 外部サービス・SDK
* **課金**: **RevenueCat** (iOS/Androidのサブスク一元管理)
* **広告**: **AdMob** (react-native-google-mobile-ads)
* **音・振動**: **expo-av**, **expo-haptics**

### 6.4 OSパーミッション（権限）

| 権限 | 利用目的（ユーザーへの説明） | 必須/任意 |
| :--- | :--- | :--- |
| **通知 (Notifications)** | 「チェーンを途切れさせないためのリマインドを送ります。」 | 任意 (SHOULD) |
| **振動 (Haptics)** | 「ボタンを押した時の感触を伝えます。」 | 必須 (System) |
| **トラッキング (ATT)** | 「あなたに最適な広告を表示します。」(iOSのみ) | 任意 |

※ カメラ、位置情報、マイク、連絡先などの**プライバシーに関わる権限は一切使用しない**。

---

## 7. リスクと対策

### 7.1 想定されるリスク
* **リスク**: アラビア語などの特殊な言語で、レイアウトが崩れてボタンが押せなくなる。
* **対策**: 開発段階で「疑似RTLモード」を使って常にレイアウト崩れがないか確認する。TamaguiのRTLサポート機能を活用する。

* **リスク**: アニメーションや振動を多用するため、古いAndroid端末で動作が重くなる。
* **対策**: `Hermes` エンジンを有効化し、低スペック端末でのパフォーマンステストを行う。重すぎる場合はエフェクトを簡易化する「Low Power Mode」の実装も検討（V1.1以降）。

---

## 8. 運用・保守方針

* **V1.0 リリース後**:
  * **機能追加は行わない**。
  * OSのアップデートに伴う不具合修正、致命的なバグの修正のみ行う。
  * ユーザーからの要望があっても、コンセプト（シンプルさ）を崩す機能は追加しないという「強い意志」を持つ。
  * 「完成された道具」として、長く使ってもらうことを目指す。

---


### 💡 補足：小中学生向け用語解説

この仕様書に出てくる少し難しい言葉を解説します。

1.  **SQLite (エスキューライト)**

      * **これ何？**: スマホの中に作れる「小さなエクセル」のようなもの。
      * **役割**: ネットが繋がっていなくても、あなたの記録をスマホの中にしっかり保存しておくための技術です。

2.  **Haptics (ハプティクス)**

      * **これ何？**: スマホの「振動」のこと。
      * **役割**: ただ震えるだけじゃなく、「コツン」「ブブッ」みたいに細かい感触を出して、ボタンを押した気持ちよさを作ります。

3.  **RTL (Right to Left)**

      * **これ何？**: 「右から左」という意味。
      * **役割**: アラビア語などの言語を使う人のために、画面のボタンや文字の並びを鏡のように反転させる仕組みです。

4.  **RevenueCat (レベニュー・キャット)**

      * **これ何？**: iPhoneとAndroidの課金システムをまとめて管理してくれる便利なサービス。
      * **役割**: これを使うと、どちらのスマホでも同じように有料プランを買ったり戻したりできます。
